/**
 * Apple-Style Flip Counter
 * Version 0.5.3 - May 7, 2011 
 *
 * Copyright (c) 2010 Chris Nanney
 * http://cnanney.com/journal/code/apple-style-counter-revisited/
 *
 * Licensed under MIT
 * http://www.opensource.org/licenses/mit-license.php
 */
var flipCounter=function(y,C){function v(){m=a.value;a.value+=a.inc;h=a.value;s(m,h);a.auto===!0&&(o=setTimeout(v,a.pace))}function z(d,f,b){var c=a.value,e=typeof f=="undefined"?!1:f,g=typeof b=="undefined"?1:b;e===!0&&g--;c!=d?(m=a.value,a.auto=!0,c+a.inc<=d&&g!=0?c+=a.inc:c=d,a.value=c,h=a.value,s(m,h),o=setTimeout(function(){z(d,e,g)},a.pace)):a.auto=!1}function s(d,f){w=d.toString().split("").reverse();t=f.toString().split("").reverse();var b,c=w.length,e=t.length;if(e>c)for(b=e-c;b>0;){var g=
t[e-b],n=Number(e-b+1)-1;i=k.createElement("ul");i.className="cd";i.id=j+"_d"+n;i.innerHTML='<li class="t" id="'+j+"_t_d"+n+'"></li><li class="b" id="'+j+"_b_d"+n+'"></li>';if(n%3==0)p=k.createElement("ul"),p.className="cd",p.innerHTML='<li class="s"></li>',l.insertBefore(p,l.firstChild);l.insertBefore(i,l.firstChild);k.getElementById(j+"_t_d"+n).style.backgroundPosition="0 -"+g*a.tFH+"px";k.getElementById(j+"_b_d"+n).style.backgroundPosition="0 -"+(g*a.bFH+a.bOffset)+"px";b--}if(e<c)for(b=c-e;b>
0;){e=k.getElementById(j+"_d"+(c-b));l.removeChild(e);e=l.firstChild.firstChild;if((" "+e.className+" ").indexOf(" s ")>-1)e=e.parentNode,l.removeChild(e);b--}for(b=0;b<c;b++)t[b]!=w[b]&&D(b,w[b],t[b])}function D(d,f,b){function c(){if(g<7){n=g<3?"t":"b";if(h=k.getElementById(j+"_"+n+"_d"+d))h.style.backgroundPosition=i[g];g++;g!=3?setTimeout(c,e):c()}}var e,g=0,n,h,i=["-"+a.fW+"px -"+f*a.tFH+"px",a.fW*-2+"px -"+f*a.tFH+"px","0 -"+b*a.tFH+"px","-"+a.fW+"px -"+(f*a.bFH+a.bOffset)+"px",a.fW*-2+"px -"+
(b*a.bFH+a.bOffset)+"px",a.fW*-3+"px -"+(b*a.bFH+a.bOffset)+"px","0 -"+(b*a.bFH+a.bOffset)+"px"];if(a.auto===!0&&a.pace<=300)switch(d){case 0:e=a.pace/6;break;case 1:e=a.pace/5;break;case 2:e=a.pace/4;break;case 3:e=a.pace/3;break;default:e=a.pace/1.5}else e=80;e=e>80?80:e;c()}function B(a,f,b,c,e){var g={result:!0};g.cond1=a/f>=1?!0:!1;g.cond2=f*b<=a?!0:!1;g.cond3=Math.abs(f*b-a)<=10?!0:!1;g.cond4=Math.abs(f*c-e)<=100?!0:!1;g.cond5=f*c<=e?!0:!1;if(g.cond1&&g.cond2&&g.cond4&&g.cond5){a=Math.abs(a-
f*b)+Math.abs(f*c-e);if(q.q===null)q.q=a;if(a<=q.q)q.pace=c,q.inc=b}for(b=1;b<=5;b++)if(g["cond"+b]===!1)g.result=!1;return g}function r(a){return!isNaN(parseFloat(a))&&isFinite(a)}function A(){clearTimeout(o);o=null}var x={value:0,inc:1,pace:1E3,auto:!0,tFH:39,bFH:64,fW:53,bOffset:390},a=C||{},k=window.document,j=typeof y!=="undefined"&&y!==""?y:"flip-counter",l=k.getElementById(j),u;for(u in x)a[u]=u in a?a[u]:x[u];var w=[],t=[],m,h,o=null,i,p,q={q:null,pace:0,inc:0};this.setValue=function(d){if(r(d))m=
a.value,h=d,a.value=d,s(m,h);return this};this.setIncrement=function(d){a.inc=r(d)?d:x.inc;return this};this.setPace=function(d){a.pace=r(d)?d:x.pace;return this};this.setAuto=function(d){if(d&&!a.atuo)a.auto=!0,v();if(!d&&a.auto)o&&A(),a.auto=!1;return this};this.step=function(){a.auto||v();return this};this.add=function(d){if(r(d))m=a.value,a.value+=d,h=a.value,s(m,h);return this};this.subtract=function(d){if(r(d))m=a.value,a.value-=d,a.value>=0?h=a.value:(h="0",a.value=0),s(m,h);return this};this.incrementTo=
function(d,f,b){o&&A();if(typeof f!="undefined"){var f=r(f)?f*1E3:1E4,b=typeof b!="undefined"&&r(b)?b:a.pace,c=typeof d!="undefined"&&r(d)?d-a.value:0,e,g,h,i=0;q.q=null;b=f/c>b?Math.round(f/c/10)*10:b;e=Math.floor(f/b);g=Math.floor(c/e);h=B(c,e,g,b,f);if(c>0){for(;h.result===!1&&i<100;)b+=10,e=Math.floor(f/b),g=Math.floor(c/e),h=B(c,e,g,b,f),i++;i==100?(a.inc=q.inc,a.pace=q.pace):(a.inc=g,a.pace=b);z(d,!0,e)}}else z(d)};this.getValue=function(){return a.value};this.stop=function(){o&&A();return this};
(function(d){var f=d.toString(),d=f.length,b=1,c;for(c=0;c<d;c++){i=k.createElement("ul");i.className="cd";i.id=j+"_d"+c;i.innerHTML=i.innerHTML='<li class="t" id="'+j+"_t_d"+c+'"></li><li class="b" id="'+j+"_b_d"+c+'"></li>';l.insertBefore(i,l.firstChild);if(b!=d&&b%3==0)p=k.createElement("ul"),p.className="cd",p.innerHTML='<li class="s"></li>',l.insertBefore(p,l.firstChild);b++}f=f.toString().split("").reverse();for(c=0;c<d;c++)k.getElementById(j+"_t_d"+c).style.backgroundPosition="0 -"+f[c]*a.tFH+
"px",k.getElementById(j+"_b_d"+c).style.backgroundPosition="0 -"+(f[c]*a.bFH+a.bOffset)+"px";a.auto===!0&&(o=setTimeout(v,a.pace))})(a.value)};

/* ---------------------------------- jQuery Timelinr 0.9.3  tested with jQuery v1.6+ ©2011 CSSLab.cl free for any use, of course... :D instructions: http://www.csslab.cl/2011/08/18/jquery-timelinr/ ---------------------------------- */  jQuery.fn.timelinr = function(options){  settings = jQuery.extend({ orientation: 				'horizontal', containerDiv: 				'#timeline', datesDiv: 					'#dates', datesSelectedClass: 		'selected', datesSpeed: 				500, issuesDiv: 					'#issues', issuesSelectedClass: 		'selected', issuesSpeed: 				200, issuesTransparency: 		0.2, issuesTransparencySpeed: 	500, prevButton: 				'#prev', nextButton: 				'#next', arrowKeys: 					'false', startAt: 					1 }, options);  $(function(){  var howManyDates = $(settings.datesDiv+' li').length; var howManyIssues = $(settings.issuesDiv+' li').length; var currentDate = $(settings.datesDiv).find('a.'+settings.datesSelectedClass); var currentIssue = $(settings.issuesDiv).find('li.'+settings.issuesSelectedClass); var widthContainer = $(settings.containerDiv).width(); var heightContainer = $(settings.containerDiv).height(); var widthIssues = $(settings.issuesDiv).width(); var heightIssues = $(settings.issuesDiv).height(); var widthIssue = $(settings.issuesDiv+' li').width(); var heightIssue = $(settings.issuesDiv+' li').height(); var widthDates = $(settings.datesDiv).width(); var heightDates = $(settings.datesDiv).height(); var widthDate = $(settings.datesDiv+' li').width(); var heightDate = $(settings.datesDiv+' li').height();   if(settings.orientation == 'horizontal') { $(settings.issuesDiv).width(widthIssue*howManyIssues); $(settings.datesDiv).width(widthDate*howManyDates).css('marginLeft',widthContainer/2-widthDate/2); var defaultPositionDates = parseInt($(settings.datesDiv).css('marginLeft').substring(0,$(settings.datesDiv).css('marginLeft').indexOf('px'))); } else if(settings.orientation == 'vertical') { $(settings.issuesDiv).height(heightIssue*howManyIssues); $(settings.datesDiv).height(heightDate*howManyDates).css('marginTop',heightContainer/2-heightDate/2); var defaultPositionDates = parseInt($(settings.datesDiv).css('marginTop').substring(0,$(settings.datesDiv).css('marginTop').indexOf('px'))); }  $(settings.datesDiv+' a').click(function(event){ event.preventDefault(); var whichIssue = $(this).text(); var currentIndex = $(this).parent().prevAll().length;   if(settings.orientation == 'horizontal') { $(settings.issuesDiv).animate({'marginLeft':-widthIssue*currentIndex},{queue:false, duration:settings.issuesSpeed}); } else if(settings.orientation == 'vertical') { $(settings.issuesDiv).animate({'marginTop':-heightIssue*currentIndex},{queue:false, duration:settings.issuesSpeed}); } $(settings.issuesDiv+' li').animate({'opacity':settings.issuesTransparency},{queue:false, duration:settings.issuesSpeed}).removeClass(settings.issuesSelectedClass).eq(currentIndex).addClass(settings.issuesSelectedClass).fadeTo(settings.issuesTransparencySpeed,1);   $(settings.datesDiv+' a').removeClass(settings.datesSelectedClass); $(this).addClass(settings.datesSelectedClass); if(settings.orientation == 'horizontal') { $(settings.datesDiv).animate({'marginLeft':defaultPositionDates-(widthDate*currentIndex)},{queue:false, duration:settings.datesSpeed}); } else if(settings.orientation == 'vertical') { $(settings.datesDiv).animate({'marginTop':defaultPositionDates-(heightDate*currentIndex)},{queue:false, duration:settings.datesSpeed}); } });  $(settings.nextButton).bind('click', function(event){ event.preventDefault(); if(settings.orientation == 'horizontal') { var currentPositionIssues = parseInt($(settings.issuesDiv).css('marginLeft').substring(0,$(settings.issuesDiv).css('marginLeft').indexOf('px'))); var currentIssueIndex = currentPositionIssues/widthIssue; var currentPositionDates = parseInt($(settings.datesDiv).css('marginLeft').substring(0,$(settings.datesDiv).css('marginLeft').indexOf('px'))); var currentIssueDate = currentPositionDates-widthDate; if(currentPositionIssues <= -(widthIssue*howManyIssues-(widthIssue))) { $(settings.issuesDiv).stop(); $(settings.datesDiv+' li:last-child a').click(); } else { if (!$(settings.issuesDiv).is(':animated')) { $(settings.issuesDiv).animate({'marginLeft':currentPositionIssues-widthIssue},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li').animate({'opacity':settings.issuesTransparency},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li.'+settings.issuesSelectedClass).removeClass(settings.issuesSelectedClass).next().fadeTo(settings.issuesTransparencySpeed, 1).addClass(settings.issuesSelectedClass); $(settings.datesDiv).animate({'marginLeft':currentIssueDate},{queue:false, duration:settings.datesSpeed}); $(settings.datesDiv+' a.'+settings.datesSelectedClass).removeClass(settings.datesSelectedClass).parent().next().children().addClass(settings.datesSelectedClass); } } } else if(settings.orientation == 'vertical') { var currentPositionIssues = parseInt($(settings.issuesDiv).css('marginTop').substring(0,$(settings.issuesDiv).css('marginTop').indexOf('px'))); var currentIssueIndex = currentPositionIssues/heightIssue; var currentPositionDates = parseInt($(settings.datesDiv).css('marginTop').substring(0,$(settings.datesDiv).css('marginTop').indexOf('px'))); var currentIssueDate = currentPositionDates-heightDate; if(currentPositionIssues <= -(heightIssue*howManyIssues-(heightIssue))) { $(settings.issuesDiv).stop(); $(settings.datesDiv+' li:last-child a').click(); } else { if (!$(settings.issuesDiv).is(':animated')) { $(settings.issuesDiv).animate({'marginTop':currentPositionIssues-heightIssue},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li').animate({'opacity':settings.issuesTransparency},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li.'+settings.issuesSelectedClass).removeClass(settings.issuesSelectedClass).next().fadeTo(settings.issuesTransparencySpeed, 1).addClass(settings.issuesSelectedClass); $(settings.datesDiv).animate({'marginTop':currentIssueDate},{queue:false, duration:settings.datesSpeed}); $(settings.datesDiv+' a.'+settings.datesSelectedClass).removeClass(settings.datesSelectedClass).parent().next().children().addClass(settings.datesSelectedClass); } } } });  $(settings.prevButton).click(function(event){ event.preventDefault(); if(settings.orientation == 'horizontal') { var currentPositionIssues = parseInt($(settings.issuesDiv).css('marginLeft').substring(0,$(settings.issuesDiv).css('marginLeft').indexOf('px'))); var currentIssueIndex = currentPositionIssues/widthIssue; var currentPositionDates = parseInt($(settings.datesDiv).css('marginLeft').substring(0,$(settings.datesDiv).css('marginLeft').indexOf('px'))); var currentIssueDate = currentPositionDates+widthDate; if(currentPositionIssues >= 0) { $(settings.issuesDiv).stop(); $(settings.datesDiv+' li:first-child a').click(); } else { if (!$(settings.issuesDiv).is(':animated')) { $(settings.issuesDiv).animate({'marginLeft':currentPositionIssues+widthIssue},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li').animate({'opacity':settings.issuesTransparency},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li.'+settings.issuesSelectedClass).removeClass(settings.issuesSelectedClass).prev().fadeTo(settings.issuesTransparencySpeed, 1).addClass(settings.issuesSelectedClass); $(settings.datesDiv).animate({'marginLeft':currentIssueDate},{queue:false, duration:settings.datesSpeed}); $(settings.datesDiv+' a.'+settings.datesSelectedClass).removeClass(settings.datesSelectedClass).parent().prev().children().addClass(settings.datesSelectedClass); } } } else if(settings.orientation == 'vertical') { var currentPositionIssues = parseInt($(settings.issuesDiv).css('marginTop').substring(0,$(settings.issuesDiv).css('marginTop').indexOf('px'))); var currentIssueIndex = currentPositionIssues/heightIssue; var currentPositionDates = parseInt($(settings.datesDiv).css('marginTop').substring(0,$(settings.datesDiv).css('marginTop').indexOf('px'))); var currentIssueDate = currentPositionDates+heightDate; if(currentPositionIssues >= 0) { $(settings.issuesDiv).stop(); $(settings.datesDiv+' li:first-child a').click(); } else { if (!$(settings.issuesDiv).is(':animated')) { $(settings.issuesDiv).animate({'marginTop':currentPositionIssues+heightIssue},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li').animate({'opacity':settings.issuesTransparency},{queue:false, duration:settings.issuesSpeed}); $(settings.issuesDiv+' li.'+settings.issuesSelectedClass).removeClass(settings.issuesSelectedClass).prev().fadeTo(settings.issuesTransparencySpeed, 1).addClass(settings.issuesSelectedClass); $(settings.datesDiv).animate({'marginTop':currentIssueDate},{queue:false, duration:settings.datesSpeed},{queue:false, duration:settings.issuesSpeed}); $(settings.datesDiv+' a.'+settings.datesSelectedClass).removeClass(settings.datesSelectedClass).parent().prev().children().addClass(settings.datesSelectedClass); } } } });   if(settings.arrowKeys=='true') { if(settings.orientation=='horizontal') { $(document).keydown(function(event){ if (event.keyCode == 39) { $(settings.nextButton).click(); } if (event.keyCode == 37) { $(settings.prevButton).click(); } }); } else if(settings.orientation=='vertical') { $(document).keydown(function(event){ if (event.keyCode == 40) { $(settings.nextButton).click(); } if (event.keyCode == 38) { $(settings.prevButton).click(); } }); } }   $(settings.datesDiv+' li').eq(settings.startAt-1).find('a').trigger('click');  });  };
/* * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/ * * Uses the built in easing capabilities added In jQuery 1.1 * to offer multiple easing options * * TERMS OF USE - jQuery Easing * * Open source under the BSD License. * * Copyright © 2008 George McGinley Smith * All rights reserved. * * Redistribution and use in source and binary forms, with or without modification, * are permitted provided that the following conditions are met: * * Redistributions of source code must retain the above copyright notice, this list of * conditions and the following disclaimer. * Redistributions in binary form must reproduce the above copyright notice, this list * of conditions and the following disclaimer in the documentation and/or other materials * provided with the distribution. * * Neither the name of the author nor the names of contributors may be used to endorse * or promote products derived from this software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE *  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING *  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED * OF THE POSSIBILITY OF SUCH DAMAGE. * */   jQuery.easing['jswing'] = jQuery.easing['swing'];  jQuery.extend( jQuery.easing, { def: 'easeOutQuad', swing: function (x, t, b, c, d) { return jQuery.easing[jQuery.easing.def](x, t, b, c, d); }, easeInQuad: function (x, t, b, c, d) { return c*(t/=d)*t + b; }, easeOutQuad: function (x, t, b, c, d) { return -c *(t/=d)*(t-2) + b; }, easeInOutQuad: function (x, t, b, c, d) { if ((t/=d/2) < 1) return c/2*t*t + b; return -c/2 * ((--t)*(t-2) - 1) + b; }, easeInCubic: function (x, t, b, c, d) { return c*(t/=d)*t*t + b; }, easeOutCubic: function (x, t, b, c, d) { return c*((t=t/d-1)*t*t + 1) + b; }, easeInOutCubic: function (x, t, b, c, d) { if ((t/=d/2) < 1) return c/2*t*t*t + b; return c/2*((t-=2)*t*t + 2) + b; }, easeInQuart: function (x, t, b, c, d) { return c*(t/=d)*t*t*t + b; }, easeOutQuart: function (x, t, b, c, d) { return -c * ((t=t/d-1)*t*t*t - 1) + b; }, easeInOutQuart: function (x, t, b, c, d) { if ((t/=d/2) < 1) return c/2*t*t*t*t + b; return -c/2 * ((t-=2)*t*t*t - 2) + b; }, easeInQuint: function (x, t, b, c, d) { return c*(t/=d)*t*t*t*t + b; }, easeOutQuint: function (x, t, b, c, d) { return c*((t=t/d-1)*t*t*t*t + 1) + b; }, easeInOutQuint: function (x, t, b, c, d) { if ((t/=d/2) < 1) return c/2*t*t*t*t*t + b; return c/2*((t-=2)*t*t*t*t + 2) + b; }, easeInSine: function (x, t, b, c, d) { return -c * Math.cos(t/d * (Math.PI/2)) + c + b; }, easeOutSine: function (x, t, b, c, d) { return c * Math.sin(t/d * (Math.PI/2)) + b; }, easeInOutSine: function (x, t, b, c, d) { return -c/2 * (Math.cos(Math.PI*t/d) - 1) + b; }, easeInExpo: function (x, t, b, c, d) { return (t==0) ? b : c * Math.pow(2, 10 * (t/d - 1)) + b; }, easeOutExpo: function (x, t, b, c, d) { return (t==d) ? b+c : c * (-Math.pow(2, -10 * t/d) + 1) + b; }, easeInOutExpo: function (x, t, b, c, d) { if (t==0) return b; if (t==d) return b+c; if ((t/=d/2) < 1) return c/2 * Math.pow(2, 10 * (t - 1)) + b; return c/2 * (-Math.pow(2, -10 * --t) + 2) + b; }, easeInCirc: function (x, t, b, c, d) { return -c * (Math.sqrt(1 - (t/=d)*t) - 1) + b; }, easeOutCirc: function (x, t, b, c, d) { return c * Math.sqrt(1 - (t=t/d-1)*t) + b; }, easeInOutCirc: function (x, t, b, c, d) { if ((t/=d/2) < 1) return -c/2 * (Math.sqrt(1 - t*t) - 1) + b; return c/2 * (Math.sqrt(1 - (t-=2)*t) + 1) + b; }, easeInElastic: function (x, t, b, c, d) { var s=1.70158;var p=0;var a=c; if (t==0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*.3; if (a < Math.abs(c)) { a=c; var s=p/4; } else var s = p/(2*Math.PI) * Math.asin (c/a); return -(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b; }, easeOutElastic: function (x, t, b, c, d) { var s=1.70158;var p=0;var a=c; if (t==0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*.3; if (a < Math.abs(c)) { a=c; var s=p/4; } else var s = p/(2*Math.PI) * Math.asin (c/a); return a*Math.pow(2,-10*t) * Math.sin( (t*d-s)*(2*Math.PI)/p ) + c + b; }, easeInOutElastic: function (x, t, b, c, d) { var s=1.70158;var p=0;var a=c; if (t==0) return b;  if ((t/=d/2)==2) return b+c;  if (!p) p=d*(.3*1.5); if (a < Math.abs(c)) { a=c; var s=p/4; } else var s = p/(2*Math.PI) * Math.asin (c/a); if (t < 1) return -.5*(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b; return a*Math.pow(2,-10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )*.5 + c + b; }, easeInBack: function (x, t, b, c, d, s) { if (s == undefined) s = 1.70158; return c*(t/=d)*t*((s+1)*t - s) + b; }, easeOutBack: function (x, t, b, c, d, s) { if (s == undefined) s = 1.70158; return c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b; }, easeInOutBack: function (x, t, b, c, d, s) { if (s == undefined) s = 1.70158; if ((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b; return c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b; }, easeInBounce: function (x, t, b, c, d) { return c - jQuery.easing.easeOutBounce (x, d-t, 0, c, d) + b; }, easeOutBounce: function (x, t, b, c, d) { if ((t/=d) < (1/2.75)) { return c*(7.5625*t*t) + b; } else if (t < (2/2.75)) { return c*(7.5625*(t-=(1.5/2.75))*t + .75) + b; } else if (t < (2.5/2.75)) { return c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b; } else { return c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b; } }, easeInOutBounce: function (x, t, b, c, d) { if (t < d/2) return jQuery.easing.easeInBounce (x, t*2, 0, c, d) * .5 + b; return jQuery.easing.easeOutBounce (x, t*2-d, 0, c, d) * .5 + c*.5 + b; } }); 
/** * AsyncSlider * JQuery plugin * * Created by: Arlind Nushi * Author email: arlindd@gmail.com * * Last Update: August 16, 2011 */   (function($){var ct;var p=this;var rotations_count=0;var callback=function(){};var bg_mask;var bg_mask_2;var slides=[];var min_time=500;var max_time=1000;var direction='horizontal';var easing='easeInOutSine';var easing_in='';var easing_out='';var keyboard_navigate=false;var prev_next_nav=true;var center_prev_next_nav=true;var prev_next_nav_margin=5;var slides_nav=true;var random=true;var autoswitch=false;var autoswitch_interval=5000;var autoswitch_interval_func=null;var current_index=0;var total_slides=0;var timeout;var horizontal_direction='';var vertical_direction='';var base_zindex=1000;var busy=false;var _next_a,_prev_a;var slides_nav_el;function sliderPrepare(el,options) {if(typeof ct=='undefined') {ct=$(el);ct.css({position:'relative'});if(typeof options=='object') {if(typeof options.direction=='string') {if(options.direction.toLowerCase()=='vertical') {direction='vertical';} else {direction='horizontal';}} if(typeof options.random!='undefined') {random=options.random;} if(typeof options.minTime!='undefined') {min_time=options.minTime;} if(typeof options.maxTime!='undefined') {max_time=options.maxTime;} if(typeof options.easing=='string') {easing=options.easing;} if(typeof options.easingIn=='string') {easing_in=options.easingIn;} if(typeof options.easingOut=='string') {easing_out=options.easingOut;} if(typeof options.keyboardNavigate!='undefined') {keyboard_navigate=options.keyboardNavigate?true:false;} if(typeof options.prevNextNav!='undefined') {prev_next_nav=options.prevNextNav;} if(typeof options.centerPrevNextNav!='undefined') {center_prev_next_nav=true;prev_next_nav_margin=parseInt(options.centerPrevNextNav,10);} if(typeof options.slidesNav!='undefined') {slides_nav=options.slidesNav;} if(typeof options.autoswitch=='number'&&options.autoswitch>0) {autoswitch=true;autoswitch_interval=options.autoswitch;_autoSwitch("on");}} else {options={};} ct.children().each(function(i) {var slide=$(this);var slide_elements=slide.find('*');slide.hide().css({zIndex:base_zindex+10,position:'relative'});slide.height=slide.outerHeight()>slide.height()?slide.outerHeight():slide.height();slide.width=slide.outerWidth();slide.background=false;var sbg="";var _bg_color=slide.css("background-color");var _bg_image=slide.css("background-image");var _bg_repeat=slide.css("background-repeat");var _bg_position=slide.css("background-position");var _bg_property=_bg_color+' '+(_bg_image=='none'?'':_bg_image)+' '+_bg_position+' '+_bg_repeat;if(_bg_image!='none'||_bg_color) {sbg=_bg_property;slide.css("background","none");} if(sbg||slide.attr("data-background")) {slide.background=sbg;if(slide.attr("data-background")) {slide.background=slide.attr("data-background");} var img_url=[];img_url=slide.background.match(/url\((.*?)\)/);if(img_url&&img_url.length>0) {var img=new Image();img.src=img_url[1];}} slide.elements=[];slide_elements.each(function() {var $this=$(this);var def_left=parseInt($this.css("left"),10);var def_top=parseInt($this.css("top"),10);$this.def_left=0;$this.def_top=0;if(def_left) {$this.def_left=def_left;} if(def_top) {$this.def_top=def_top;} if($this.css('position')!='absolute') {$this.css({position:'relative'});} $this.css({zIndex:base_zindex+10});if($this.get(0).tagName!="BR") {slide.elements.push($this);}});slide.index=parseInt(i,10);slides.push(slide);if(i===0) {slide.show();ct.height(slide.height).css({overflow:'hidden'});bg_mask=$('<div id="asyncslider_background_mask"></div>');bg_mask_2=$('<div id="asyncslider_background_mask_2"></div>');slide.before(bg_mask);slide.before(bg_mask_2);bg_mask.css({position:'absolute',top:0,left:0,zIndex:base_zindex+1,padding:0,margin:0,width:ct.outerWidth(),height:ct.outerHeight()});bg_mask_2.css({position:'absolute',top:0,left:0,zIndex:base_zindex+2,padding:0,margin:0,width:ct.outerWidth(),height:ct.outerHeight()});$(window).resize(function() {bg_mask.width(ct.outerWidth());bg_mask_2.width(ct.outerWidth());});if(slide.background) {bg_mask.css("background",slide.background);}}});total_slides=slides.length;if(typeof options!='undefined'&&typeof options.firstSlide!='undefined') {var fs_index=options.firstSlide-1;if(fs_index>=0&&fs_index<total_slides) {var tmp_min_time=min_time,tmp_max_time=max_time,tmp_callback=callback;min_time=max_time=0;callback=function(){};current_index=fs_index;switchSlide(current_index,0);min_time=tmp_min_time;max_time=tmp_max_time;callback=tmp_callback;}} if(ct.children().length<2) {return;} $(window).keydown(function(e){if(keyboard_navigate) {switch(e.keyCode) {case 37:prevSlide();break;case 39:nextSlide();break;}}});if(prev_next_nav&&total_slides>1) {var next_prev_nav_el=$('<ul id="asyncslider_next_prev_nav" />');next_prev_nav_el.css({zIndex:base_zindex+100});var prev_li=$('<li class="prev" />');var next_li=$('<li class="next" />');var prev_a=$('<a href="#">Previous</a>');var next_a=$('<a href="#">Next</a>');next_prev_nav_el.append(prev_li);next_prev_nav_el.append(next_li);prev_li.append(prev_a);next_li.append(next_a);prev_li.click(function(ev) {ev.preventDefault();prevSlide();});next_li.click(function(ev) {ev.preventDefault();nextSlide();});if(typeof prev_next_nav=='object') {prev_next_nav.append(next_prev_nav_el);} else {ct.append(next_prev_nav_el);if(center_prev_next_nav) {var margin_h=prev_next_nav_margin;var current_slide=getSlide(current_index);next_prev_nav_el.css({position:'absolute',left:"50%",margin:0,padding:0,listStyle:'none',marginLeft:-parseInt(current_slide.outerWidth()/2,10),top:0});next_prev_nav_el.find('*').css({margin:0,padding:0});var next=next_prev_nav_el.find('.next');var prev=next_prev_nav_el.find('.prev');_next_a=next.children();_prev_a=prev.children().css({left:-prev_a.width()-margin_h});prev.add(next).css({position:'relative'});prev.width(_prev_a.width());next.width(_next_a.width());_next_a.add(_prev_a).css({position:'absolute'});_next_a.css({left:current_slide.outerWidth()+margin_h,top:parseInt(current_slide.outerHeight()/2-_prev_a.outerHeight()/2,10)});_prev_a.css({top:parseInt(current_slide.outerHeight()/2-_prev_a.outerHeight()/2,10)});}}} if(slides_nav) {slides_nav_el=$('<ul id="asyncslider_slides_nav" />');slides_nav_el.css({zIndex:base_zindex+100});for(var i=0;i<slides.length;i++) {var slide=slides[i];var slide_button_li=$('<li id="asyncslider_slide_'+(parseInt(i,10)+1)+'" />');var slide_button_a=$('<a href="#" rel="'+(i)+'">'+(parseInt(i,10)+1)+'</a>');if(i===0&&typeof options.firstSlide=='undefined') {slide_button_li.addClass('active');} else if(typeof options.firstSlide!='undefined'&&i==parseInt(options.firstSlide,10)-1) {slide_button_li.addClass('active');} slides_nav_el.append(slide_button_li);slide_button_li.append(slide_button_a);index=parseInt(i,10);var btn_click_a=slide_button_a.click(function(ev) {ev.preventDefault();if(busy) {return false;} slides_nav_el.find('li').removeClass('active');$(this).parent().addClass('active');var i=parseInt($(this).attr("rel"),10);var old_index=current_index;current_index=i;switchSlide(current_index,old_index);});} if(typeof slides_nav=='object') {slides_nav.append(slides_nav_el);} else {ct.append(slides_nav_el);}}}} function setIndex(index) {if(index>=0&&index<total_slides) {current_index=index;}} function getSlide(index) {if(index>=0&&index<total_slides) {return slides[index];} return null;} function nextSlide(_direction) {if(busy) {return false;} var old_index=current_index;current_index++;current_index=current_index%total_slides;horizontal_direction='left';vertical_direction='bottom';if(_direction) {horizontal_direction=_direction=='right'?'right':'left';} if(_direction) {vertical_direction=_direction=='bottom'?'top':'bottom';} switchSlide(current_index,old_index);} function prevSlide(_direction) {if(busy) {return false;} var old_index=current_index;current_index--;current_index=current_index<0?(total_slides-1):current_index;horizontal_direction='right';vertical_direction='top';if(_direction) {horizontal_direction=_direction=='left'?'left':'right';} if(_direction) {vertical_direction=_direction=='top'?'bottom':'top';} switchSlide(current_index,old_index);} function switchSlide(_in,_out) {var current_slide=getSlide(_out);var next_slide=getSlide(_in);if((!current_slide||!next_slide)||_in==_out) {return false;} if(busy) {return false;} busy=true;var half_m=parseInt((max_time+min_time)/2,10);max_time=min_time>max_time?min_time:max_time;min_time=min_time>max_time?max_time:min_time;if(next_slide.background) {if(!current_slide.background) {bg_mask.css({background:next_slide.background}).hide().fadeTo(half_m,1);} else {if(rotations_count==0) {bg_mask.css({background:current_slide.background});bg_mask_2.hide().css({background:next_slide.background}).stop().fadeTo(half_m,1);} else {bg_mask.css({background:next_slide.background}).show();bg_mask_2.stop().fadeTo(half_m,0,function(){bg_mask.hide();bg_mask_2.css({background:next_slide.background}).fadeTo(0,1);});}}} else {bg_mask_2.stop().fadeTo(half_m,0);bg_mask.stop().fadeTo(half_m,0);} if(center_prev_next_nav&&_next_a&&_prev_a) {_next_a.stop().animate({top:parseInt(next_slide.outerHeight()/2-_next_a.outerHeight()/2,10)},half_m);_prev_a.stop().animate({top:parseInt(next_slide.outerHeight()/2-_prev_a.outerHeight()/2,10)},half_m);} bg_mask.stop().animate({height:next_slide.height},half_m);bg_mask_2.height(next_slide.height);if(slides_nav_el) {slides_nav_el.find('li').removeClass('active').filter(':nth-child('+(next_slide.index+1)+')').addClass('active');} var turn=1,i,el,time_seq,time_seq_step,def_left,def_top,animation_length,move_top,move_left;if(direction=='horizontal') {var win=$(window);var win_ct_gap_size=win.width()-next_slide.width;ct.css({overflow:"hidden"}).stop().animate({height:next_slide.height},half_m);var move_left_1=parseInt(current_slide.width/2+win_ct_gap_size/2,10);if(_in>_out) {move_top=current_slide.height;if(move_top<next_slide.height) {move_top=next_slide.height-(next_slide.height-current_slide.height);} current_slide.css({position:'relative',zIndex:base_zindex+3});next_slide.css({position:'relative',zIndex:base_zindex+4,top:-move_top}).show();turn=1;} else {move_top=current_slide.height;if(move_top<next_slide.height) {move_top=next_slide.height;} else {move_top-=(current_slide.height-next_slide.height);} current_slide.css({position:'relative',zIndex:base_zindex+3,top:-move_top});next_slide.css({position:'relative',zIndex:base_zindex+4}).show();turn=-1;} if(horizontal_direction) {if(horizontal_direction=='right') {turn=-1;} else {turn=1;}} if(!easing_in) {easing_in=easing;} if(!easing_out) {easing_out=easing;} time_seq=min_time;time_seq_step=parseInt((max_time-min_time)/current_slide.elements.length,10);move_left=current_slide.width+win_ct_gap_size;for(i=0;i<current_slide.elements.length;i++) {el=current_slide.elements[i];def_left=el.def_left;def_top=el.def_top;animation_length=randomFromTo(min_time,max_time);move_left_1=move_left;if(!random) {time_seq+=time_seq_step;animation_length=time_seq;} el.stop().animate({left:-turn*move_left_1+def_left,top:def_top+0},animation_length,easing_in);} time_seq=min_time;time_seq_step=parseInt((max_time-min_time)/next_slide.elements.length,10);move_left=next_slide.width+win_ct_gap_size;var next_slide_total_elements=next_slide.elements.length;for(i=0;i<next_slide.elements.length;i++) {el=next_slide.elements[i];def_left=el.def_left;def_top=el.def_top;animation_length=randomFromTo(min_time,max_time);move_left_1=move_left+randomFromTo(0,el.outerWidth());if(!random) {time_seq+=time_seq_step;animation_length=time_seq;} var _index=parseInt(i,10);el.css({left:turn*move_left_1+def_left,top:def_top+0}).stop().animate({left:0+def_left},animation_length,easing_out);}} else {ct.css({overflow:"hidden"}).stop().animate({height:next_slide.height},half_m);var move_top_1=ct.height();if(_in>_out) {current_slide.css({position:'relative',zIndex:base_zindex+3});next_slide.css({position:'relative',zIndex:base_zindex+4,top:-current_slide.height}).show();turn=1;} else {current_slide.css({position:'relative',zIndex:base_zindex+3,top:-current_slide.height});next_slide.css({position:'relative',zIndex:base_zindex+4}).show();turn=-1;} if(vertical_direction) {if(vertical_direction=='top') {turn=-1;} else {turn=1;}} if(!easing_in) {easing_in=easing;} if(!easing_out) {easing_out=easing;} current_slide.animate({top:-turn*move_top_1},half_m);time_seq=min_time;time_seq_step=parseInt((max_time-min_time)/current_slide.elements.length,10);for(i=0;i<current_slide.elements.length;i++) {el=current_slide.elements[i];def_left=el.def_left;def_top=el.def_top;animation_length=randomFromTo(min_time,max_time);move_top=move_top_1;if(!random) {time_seq+=time_seq_step;animation_length=time_seq;} el.stop().animate({top:-turn*move_top+def_top},animation_length,easing_in);} time_seq=min_time;time_seq_step=parseInt((max_time-min_time)/next_slide.elements.length,10);for(i=0;i<next_slide.elements.length;i++) {el=next_slide.elements[i];def_left=el.def_left;def_top=el.def_top;animation_length=randomFromTo(min_time,max_time);move_top=move_top_1;if(!random) {time_seq+=time_seq_step;animation_length=time_seq;} el.css({top:turn*move_top,left:0+def_left}).stop().animate({top:0+def_top},animation_length,easing_out);}} timeout=window.setTimeout(function(){current_slide.css({position:'relative',top:0,left:0}).hide();next_slide.css({position:'relative',top:0,left:0});for(i=0;i<current_slide.elements.length;i++) {el=current_slide.elements[i];def_left=el.def_left;def_top=el.def_top;el.css({left:def_left});el.css({top:def_top});} for(i=0;i<next_slide.elements.length;i++) {el=next_slide.elements[i];def_left=el.def_left;def_top=el.def_top;el.css({left:def_left});el.css({top:def_top});} horizontal_direction='';callback(next_slide.index+1);window.clearTimeout(timeout);timeout=null;busy=false;if(typeof autoswitch_interval_func!='undefined') {if(autoswitch) {window.clearTimeout(autoswitch_interval_func);autoswitch_interval_func=null;_autoSwitch("on");}} rotations_count++;},max_time);return true;} function randomFromTo(from,to) {return Math.floor(Math.random()*(to-from+1)+from);} function setOption(_var,_val) {switch(_var.toLowerCase()) {case"direction":if(_val=="vertical") {direction='vertical';} else {direction='horizontal';} break;case"callback":if(typeof _val=='function') {callback=_val;} break;case"minTime":min_time=parseInt(_val,10);break;case"maxTime":max_time=parseInt(_val,10);break;case"easing":easing_in='';easing_out='';easing=_val;break;case"easingin":easing_in=_val;break;case"easingout":easing_out=_val;break;case"keyboardnavigate":keyboard_navigate=_val?true:false;break;case"random":random=_val?true:false;break;case"autoswitch":if(typeof _val=='number'&&_val>0) {_autoSwitch("update_interval",_val);} else if(typeof _val=='string'&&(_val.toLowerCase()=='play'||_val.toLowerCase()=='on'||_val.toLowerCase()=='off'||_val.toLowerCase()=='pause')) {_autoSwitch(_val.toLowerCase());} else if(typeof _val=='string'&&_val.toLowerCase()=='pause') {_autoSwitch("pause");} break;}} function _autoSwitch(type,new_value) {switch(type) {case"off":autoswitch=false;if(typeof autoswitch_interval_func!='undefined') {window.clearInterval(autoswitch_interval_func);autoswitch_interval_func=null;} break;case"on":_autoSwitch("update_interval",autoswitch_interval);break;case"update_interval":autoswitch=true;autoswitch_interval=new_value;if(typeof autoswitch_interval_func!='undefined') {window.clearInterval(autoswitch_interval_func);autoswitch_interval_func=null;} autoswitch_interval_func=setInterval(function() {if(autoswitch) {nextSlide();}},autoswitch_interval);break;case"play":autoswitch=true;if(typeof autoswitch_interval_func=='undefined') {_autoSwitch("on");} break;case"pause":autoswitch=false;break;}} $.fn.extend({asyncSlider:function(options,_var,_val) {if(typeof options=='string') {switch(options.toLowerCase()) {case"movetoslide":var move_to_slide=parseInt(_var,10);if(move_to_slide>0&&move_to_slide<=total_slides) {var old_index=current_index;current_index=move_to_slide-1;if(_val) {horizontal_direction=_val=='right'?'right':'left';} if(_val) {vertical_direction=_val=='bottom'?'top':'bottom';} switchSlide(current_index,old_index);} break;case"set":setOption(_var,_val);break;case"next":nextSlide(_var);break;case"prev":prevSlide(_var);break;}} sliderPrepare(this,options);if(typeof _var=='function') {callback=_var;}}});}) (jQuery);
/* Copyright (c) 2009 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 *
 * Version: 3.0.2
 * 
 * Requires: 1.2.2+
 */
(function(c){var a=["DOMMouseScroll","mousewheel"];c.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var d=a.length;d;){this.addEventListener(a[--d],b,false)}}else{this.onmousewheel=b}},teardown:function(){if(this.removeEventListener){for(var d=a.length;d;){this.removeEventListener(a[--d],b,false)}}else{this.onmousewheel=null}}};c.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}});function b(f){var d=[].slice.call(arguments,1),g=0,e=true;f=c.event.fix(f||window.event);f.type="mousewheel";if(f.wheelDelta){g=f.wheelDelta/120}if(f.detail){g=-f.detail/3}d.unshift(f,g);return c.event.handle.apply(this,d)}})(jQuery);
/*
Item Name: jQuery Carousel Evolution
Author: Mapalla
Author URI: http://codecanyon.net/user/Mapalla
Version: 1.1
*/

(function($){

    var CarouselEvo = function(element, options){
        var settings = $.extend({}, $.fn.carousel.defaults, options),
            self = this,
            element = $(element),
            carousel = element.children('.slides');
            
        carousel.children('div').addClass('slideItem');
        var slideItems = carousel.children('.slideItem'),
            slideImage = slideItems.find('img'),
            currentSlide = 0,
            targetSlide = 0,
            numberSlides = slideItems.length,
            isAnimationRunning = false, 
            pause = true ;
            videos = {
                youtube: {
                    reg: /youtube\.com\/watch/i, 
                    split: '=', 
                    index: 1, 
                    url:'http://www.youtube.com/embed/%id%?autoplay=1&amp;fs=1&amp;rel=0'},
                vimeo: {
                    reg: /vimeo\.com/i, 
                    split: '/', 
                    index: 3, 
                    url: 'http://player.vimeo.com/video/%id%?portrait=0&amp;autoplay=1'}
            };
            
        this.current = currentSlide;
        this.length = numberSlides;
        
        this.init = function(){
            var o = settings ;
            
            initSlides();
            
            if (o.directionNav == true){
                initDirectionButton();
            }
                            
            if (o.buttonNav != 'none'){
                initButtonNav();
            }
            
            if (o.reflection == true){
                initReflection();
            }
            
            if (o.shadow == true){
                initShadow();
            }
            
            if (o.description == true){
                initDesc();
            }
            
            if (o.autoplay == true){
                runAutoplay();
            }
            
            initVideo();
                         
        };
            
        /* _________________________________ */
    
        /* IMAGE */
        /* _________________________________ */
           
        var setImageSize = function(p){
            var o = settings,
                n = numberSlides ,
                w = o.frontWidth, 
                h = o.frontHeight, 
                ret;
                
            if (p != 0){
                if (o.hAlign == 'center') {
                    if (p > 0 && p <= Math.ceil((n-1)/2)){
                        var front = setImageSize(p-1);
                        w = o.backZoom * front.width ;
                        h = o.backZoom * front.height ;
                    }
                    else {
                        var sz = setImageSize(n-p);
                        w = sz.width;
                        h = sz.height;
                    }
                }    
                else {
                    if (p == (n -1)){
                        w = o.frontWidth / o.backZoom;
                        h = o.frontHeight / o.backZoom;
                    }
                    else{
                        var front = setImageSize(p-1);
                        w = o.backZoom * front.width ;
                        h = o.backZoom * front.height ;
                    }
                } 
            }          
            
            return ret = {width:w, height:h};
        };
        
        /* _______________________________ */
        
        /* SLIDE */
        /* _______________________________ */
        
        var setSlideSize = function(p){
            var o = settings,
                n = numberSlides ,
                w = o.frontWidth, 
                h = o.frontHeight + reflectionHeight(p) + shadowHeight(p),
                ret;
                
            if (p != 0){            
                if (o.hAlign == 'center'){
                    if (p > 0 && p <= Math.ceil((n-1)/2)){
                        var front = setImageSize(p-1);
                        w = o.backZoom * front.width ;
                        h = (o.backZoom * front.height) + reflectionHeight(p) + shadowHeight(p);
                    }
                    else {
                        var sz = setSlideSize(n - p);
                        w = sz.width;
                        h = sz.height;
                    }
                }    
                else {

                    if (p == (n -1)){
                        w = o.frontWidth / o.backZoom;
                        h = (o.frontHeight/o.backZoom) + reflectionHeight(p) + shadowHeight(p);
                    }
                    else{
                        var front = setImageSize(p-1);
                        w = o.backZoom * front.width ;
                        h = (o.backZoom * front.height) + reflectionHeight(p) + shadowHeight(p);
                    }
                }
            }            
            
            return ret = {width:w, height:h};
        };       
        
        var getMargin = function(p){            
            var o = settings,
            vm, hm, ret, 
            iz = setImageSize(p);
            
            vm = iz.height * o.vMargin;
            hm = iz.width * o.hMargin;
            return ret = {vMargin:vm, hMargin:hm};
        };
                
        var centerPos = function(p){
            var o = settings,
                c = topPos(p-1) + (setImageSize(p-1).height - setImageSize(p).height)/2;
            
            if (o.hAlign != 'center'){
                if (p == (numberSlides -1)){
                    c = o.top - ((setImageSize(p).height - setImageSize(0).height)/2);
                }
            }
            return c;            
        };
        
        var topPos = function(p){
            var o = settings,
                t = o.top,
                vm = getMargin(p).vMargin ;
                
            if (o.vAlign == 'bottom'){
                t = o.bottom;
            } 
            
            if (p != 0){    
                if (o.hAlign == 'center'){
                    if (p > 0 && p <= Math.ceil((numberSlides-1)/2)){
                        if (o.vAlign == 'center'){
                            t = centerPos(p);
                        }
                        else {
                            t = centerPos(p) + vm;
                        }         
                    }
                    else{
                        t = topPos(numberSlides -p);
                    }            
                }
                else {
                    if (p == (numberSlides -1)){
                        if (o.vAlign == 'center'){
                            t = centerPos(p);
                        }
                        else {
                            t = centerPos(p) - vm;
                        }                           
                    }
                    else{
                        if (o.vAlign == 'center'){
                            t = centerPos(p);
                        }
                        else {
                            t = centerPos(p) + vm ;
                        }                   
                    }                              
                }
            }
                
            return t;                     
        };
        
        var horizonPos = function(p){
            var o = settings,
                n = numberSlides ,
                hPos,
                mod = n % 2,
                endSlide = n / 2,
                hm = getMargin(p).hMargin;     
            
            if (p == 0){
                 if (o.hAlign == 'center'){
                    hPos = (o.carouselWidth - o.frontWidth)/2;
                 }
                 else {
                    hPos = o.left ;
                    if (o.hAlign == 'right'){
                        hPos = o.right;
                    }
                 }
            }
            else {                       
                if (o.hAlign == 'center'){
                    if (p > 0 && p <= Math.ceil((n-1)/2)){
                        hPos = horizonPos(p-1) - hm;
                    
                        if (mod == 0){
                            if (p == endSlide){
                                hPos = (o.carouselWidth - setSlideSize(p).width)/2 ;
                            }
                        }                
                    }
                    else{
                        hPos = o.carouselWidth - horizonPos(n-p) - setSlideSize(p).width;
                    }                   
                }
                else {
                    if (p == (n -1)){
                        hPos = horizonPos(0) - (setSlideSize(p).width - setSlideSize(0).width)/2 - hm;
                    }
                    else{
                        hPos = horizonPos(p-1) + (setSlideSize(p-1).width - setSlideSize(p).width)/2 + hm;
                    }
                }
            }
                
            return hPos;           
        };
        
        var setOpacity = function(p){
            var o = settings,
                n = numberSlides ,
                opc = 1, 
                hiddenSlide = n - o.slidesPerScroll; 
        
            if (hiddenSlide < 2){
                hiddenSlide = 2;
            }
            
            if (o.hAlign == 'center'){
                var s1 = (n-1)/2,
                    hs2 = hiddenSlide / 2,
                    lastSlide1 = (s1+1) - hs2,
                    lastSlide2 = s1 + hs2;
                    
                if (p == 0){
                    opc = 1;
                }
                else {
                    opc = o.backOpacity;
                    if (p >= lastSlide1 && p <= lastSlide2){ 
                        opc = 0;
                    }
                }                             
            }
            else { 
                if (p == 0){
                    opc = 1;
                }
                else {
                    opc = o.backOpacity;
                    if (!(p < (n - hiddenSlide))){
                        opc = 0 ;
                    }
                }      
            }
            
            return opc;                    
        };
        
        var setSlidePosition = function(p) {
            var pos = new Array(),
                o = settings,
                n = numberSlides ;
                        
            for (var i = 0; i < n; i++){
                var sz = setSlideSize(i);
                if (o.hAlign == 'left'){
                    pos[i] = {width:sz.width, height:sz.height, top:topPos(i), left:horizonPos(i), opacity:setOpacity(i)};
                    if (o.vAlign == 'bottom'){
                        pos[i] = {width:sz.width, height:sz.height, bottom:topPos(i), left:horizonPos(i), opacity:setOpacity(i)} ;
                    }
                }
                else {
                    pos[i] = {width:sz.width, height:sz.height, top:topPos(i), right:horizonPos(i), opacity:setOpacity(i)} ;
                    if (o.vAlign == 'bottom'){
                        pos[i] = {width:sz.width, height:sz.height, bottom:topPos(i), right:horizonPos(i), opacity:setOpacity(i)} ;
                    }
                }
            }                                            
            return pos[p];  
        };
        

        var slidePos = function(i) {
            var cs = currentSlide, 
            pos = i - cs;
            
            if (i < cs){
                pos += numberSlides ; 
            }
                
            return pos;       
        };
        
        var zIndex = function(i){            
            var z,
                n = numberSlides ,
                hAlign = settings.hAlign;
                
            if (hAlign == 'left' || hAlign == 'right'){
                if (i == (n - 1)){
                    z = n - 1;
                }
                else {
                    z = n - (2+i);
                }
            }
            else {
                if (i >= 0 && i <= ((n - 1)/2)){
                    z = (n - 1) - i;
                }
                else {
                    z = i - 1 ;
                }
            }                                
            return z;
        };
        
        var slidesMouseOver = function(event){
            var o = settings ;
            if (o.autoplay == true && o.pauseOnHover == true){
                stopAutoplay();
            }
        };
        
        var slidesMouseOut = function(event){
            var o = settings ;
            if (o.autoplay == true && o.pauseOnHover == true){
                if (pause == true){
                    runAutoplay();
                }
            }
        };       
        
        var initSlides = function(){
            var o = settings,
                n = numberSlides,
                images = slideImage ;
                
            carousel
                .css({'width':o.carouselWidth+'px', 'height':o.carouselHeight+'px'})
                .bind('mouseover', slidesMouseOver)
                .bind('mouseout', slidesMouseOut);
    
            for (var i = 0; i < n; i++){
                var item = slideItems.eq(i);
                item
                    .css(setSlidePosition(slidePos(i)))
                    .bind('click', slideClick);
                    
                slideItems.eq(slidePos(i)).css({'z-index':zIndex(i)});
                images.eq(i).css(setImageSize(slidePos(i)));
                    
                var op = item.css('opacity');
                if (op == 0){
                    item.hide();
                }
                else {
                    item.show();
                }                                   
            }
            

            if (o.mouse == true){
                carousel.mousewheel(function(event, delta){
                    if (delta > 0){
                        goTo(currentSlide-1, true, false);
                        return false ;
                    }
                    else if (delta < 0){
                        goTo(currentSlide+1, true, false);
                        return false ;
                    }
                });
            }                  
        };
        
        var hideItem = function(slide){
            var op = slide.css('opacity');
            if (op == 0){ slide.hide();}    
        };
        
        var goTo = function(index, isStopAutoplay, isPause){
            if (isAnimationRunning == true){return;}
            
            var o = settings,
                n = numberSlides ;
                
            if (isStopAutoplay == true){ 
                stopAutoplay(); 
            }
            
            targetSlide = index;
            if (targetSlide == n){ targetSlide = 0; }
            if (targetSlide == -1){ targetSlide = n - 1; }
            o.before(self);
            animateSlide();  
            pause = isPause ;
        };
        
        var animateSlide = function(){
            var o = settings,
                n = numberSlides;
                      
            if (isAnimationRunning == true ){ return ; }
            
            if (currentSlide == targetSlide){
                isAnimationRunning = false ;
                return ;
            }
        
            isAnimationRunning = true ;
            
            hideDesc(currentSlide);       
        

            if (currentSlide > targetSlide) {
                var forward = n - currentSlide + targetSlide,
                    backward = currentSlide - targetSlide;
            } 
            else {
                var forward = targetSlide - currentSlide,
                    backward = currentSlide + n - targetSlide ;
            }
            
            if (forward > backward) {
                dir = -1;
            } 
            else {
                dir = 1;
            }
            
            currentSlide += dir;
            if (currentSlide == n) { currentSlide = 0; }
            if (currentSlide == -1) { currentSlide = n - 1; }
            
            hideVideoOverlay();
            buttonNavState();
            showDesc(currentSlide);
                    
 
            for (var i = 0; i < n; i++){
                animateImage(i);                                                    
            }              
               
        };        
            
        var animateImage = function(i){
            var o = settings,
                item = slideItems.eq(i),
                pos = slidePos(i);
            
            item.show();
            item.animate(setSlidePosition(pos), o.speed, 'linear', function(){
                hideItem($(this));            
                if (i == numberSlides - 1){
                    isAnimationRunning = false ;
                    if (currentSlide != targetSlide){ 
                        animateSlide();
                    }
                    else {
                        self.current = currentSlide ;
                        showVideoOverlay(currentSlide);
                        o.after(self);                  
                    }                                                                               
                }
            });
                
            item.css({'z-index':zIndex(pos)});
            slideImage.eq(i).animate(setImageSize(pos), o.speed, 'linear');
            
            if (o.reflection == true){
                animateReflection(o, item, i);
            }
            
            if (o.shadow == true){
                animateShadow(o, item, i);
            }  
        };
        
        var slideClick = function(event){
            var $this = $(this);
            if ($this.index() != currentSlide){
                goTo($this.index(), true, false);
                return false;
            }                          
        };
        
        /* ________________________________ */
        
        /* REFLECTION */
        /* ________________________________ */
        
        var reflectionHeight = function(p){
            var h = 0,
                o = settings ;
                
            if (o.reflection == true){
                h =  o.reflectionHeight * setImageSize(p).height;
            }
            
            return h ;
        };
        
        var initReflection = function(){
            var o = settings ,
                items = slideItems ,
                images = slideImage ,
                n = numberSlides,
                opc = o.reflectionOpacity,
                start = 'rgba('+o.reflectionColor+','+ opc +')',
                end = 'rgba('+o.reflectionColor+',1)';
                
            var style = '<style type="text/css">';
                style += '.slideItem .gradient {';
                style += 'position:absolute; left:0; top:0; margin:0; padding:0; border:none; width:100%; height:100%; ';
                style += 'background: -moz-linear-gradient('+start+','+end+'); ';
                style += 'background: -o-linear-gradient('+start+','+end+'); ';
                style += 'background: -webkit-linear-gradient('+start+','+end+'); ';
                style += 'background: -webkit-gradient(linear, 0% 0%, 0% 100%, from('+start+'), to('+end+')); ';
                style += 'background: linear-gradient('+start+','+end+'); ';
                style += '} ';
                style += '.slideItem .reflection {';
                style += 'filter: progid:DXImageTransform.Microsoft.Alpha(style=1,opacity='+(opc*100)+',finishOpacity=0,startX=0,finishX=0,startY=0,finishY=100)';
                style += '-ms-filter: progid:DXImageTransform.Microsoft.Alpha(style=1,opacity='+(opc*100)+',finishOpacity=0,startX=0,finishX=0,startY=0,finishY=100)';
                style += '}';
                style += '</style>';
                
            $(style).appendTo('head');
                
            for (var i=0; i < n; i++){
                var src = images.eq(i).attr('src'),
                    sz = setImageSize(i);
                
                $('<div class="reflection"></div>')
                    .css({'position':'absolute', 'margin':'0', 'padding':'0', 'border':'none', 'overflow':'hidden', 'left':'0', 
                        'top':setImageSize(i).height+'px', 'width':'100%', 'height':reflectionHeight(i)})
                    .appendTo(items.eq(i))
                    .append($('<img src="'+src+'" />').css({'width':sz.width+'px', 'height':sz.height+'px', 'left':'0','margin':'0', 
                        'padding':'0', 'border':'none', '-moz-transform':'rotate(180deg) scale(-1,1)', 
                        '-webkit-transform':'rotate(180deg) scale(-1,1)', '-o-transform':'rotate(180deg) scale(-1,1)', 
                        'transform':'rotate(180deg) scale(-1,1)', 'filter': 'progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)', 
                        '-ms-filter': 'progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)'}))
                    .append('<div class="gradient"></div>');
            }
        };    
                
        var animateReflection = function(option, item, i){
            var ref = item.children('.reflection'),
                speed = option.speed,
                sz = setImageSize(slidePos(i));
                
            ref.animate({'top':sz.height+'px', 'height':reflectionHeight(slidePos(i))}, speed, 'linear');
            ref.children('img').animate(sz, speed, 'linear');        
        };
        
        /* ________________________________ */
        
        /* SHADOW */
        /* ________________________________ */
        
        var shadowHeight = function(p){
            var sh = 0;
            if (settings.shadow == true){
                sh =  0.1 * setImageSize(p).height;
            }
            return sh ;
        };
        
        var shadowMiddleWidth = function(p){
            var w,
                s = slideItems.eq(p).find('.shadow'),
                sL = s.children('.shadowLeft'),
                sR = s.children('.shadowRight'),
                sM = s.children('.shadowMiddle');
            return w = setImageSize(p).width - (sL.width() + sR.width());
        };
        
        var initShadow = function(){
            var items = slideItems, 
                n = numberSlides,
                sWidth = setImageSize(0).width,
                sInner = '<div class="shadowLeft"></div><div class="shadowMiddle"></div><div class="shadowRight"></div>';
                
            if (settings.hAlign != 'center'){
                sWidth = setImageSize(n-1).width;
            }
                                       
            for (var i = 0; i < n; i++){
                var item = items.eq(i);
                $('<div class="shadow"></div>')
                    .css({'width':sWidth+'px', 'z-index':'-1', 'position':'absolute', 'margin':'0', 'padding':'0', 'border':'none', 
                        'overflow':'hidden', 'left':'0', 'bottom':'0'})
                    .append(sInner)
                    .appendTo(item)
                    .children('div').css({'position':'relative', 'float':'left'});
                
                item.find('.shadow').children('.shadowMiddle').width(shadowMiddleWidth(i));         
            }        
        };
        
        var animateShadow = function(option, item, i){
            item.find('.shadow').children('.shadowMiddle').animate({'width':shadowMiddleWidth(slidePos(i))+'px'}, option.speed, 'linear');
        };
        
        /* ________________________________ */
        
        /* DIRECTION BUTTONS */
        /* ________________________________ */
        
        var initDirectionButton = function(){
            var el = element ;
            el.append('<div class="nextButton"></div><div class="prevButton"></div>');
            el.children('.nextButton').bind('click', function(event){
                goTo(currentSlide+1, true, false);
            });
            
            el.children('.prevButton').bind('click', function(event){
                goTo(currentSlide-1, true, false);    
            });        
        };
        
        /* ________________________________ */
        
        /* BUTTON NAV */
        /* ________________________________ */   
        
        var initButtonNav = function(){
            var el = element,
                n = numberSlides,
                buttonName = 'bullet',
                activeClass = 'bulletActive';
                
            if (settings.buttonNav == 'numbers'){
                buttonName = 'numbers';
                activeClass = 'numberActive';
            }                   
                
            el.append('<div class="buttonNav"></div>');
            var buttonNav = el.children('.buttonNav') ;
                
            for (var i = 0; i < n; i++){
                var number = '';
                if (buttonName == 'numbers'){ number = i+1 ; }
            
                $('<div class="'+buttonName+'">'+number+'</div>')
                    .css({'text-align':'center'})
                    .bind('click', function(event){
                        goTo($(this).index(), true, false);
                    })
                    .appendTo(buttonNav);                                   
            }
            
            var b = buttonNav.children('.'+buttonName);
            b.eq(0).addClass(activeClass)                    
            buttonNav.css({'width':numberSlides * b.outerWidth(true), 'height':b.outerHeight(true)});
        };
        
        var buttonNavState = function(){
            var o = settings,
                buttonNav = element.children('.buttonNav');
                
            if (o.buttonNav == 'numbers'){    

                var numbers = buttonNav.children('.numbers') ;
                numbers.removeClass('numberActive');
                numbers.eq(currentSlide).addClass('numberActive');
            }
            else {    
 
                var bullet = buttonNav.children('.bullet') ;
                bullet.removeClass('bulletActive');
                bullet.eq(currentSlide).addClass('bulletActive');            
            }
        };
        
        /* ________________________________ */
        
        /* DESCRIPTION */
        /* ________________________________ */
        
        var initDesc = function(){
            var desc = $(settings.descriptionContainer),
                w = desc.width(), 
                h = desc.height(),
                descItems = desc.children('div'),
                n = descItems.length;
                
                for (var i = 0; i < n; i++){
                    descItems.eq(i)
                        .hide()
                        .css({'position':'absolute', 'top':'0', 'left':'0'});
                }
                
                descItems.eq(0).show();
        };
        
        var hideDesc = function(index){
            var o = settings ;
            if (o.description == true){
                var desc = $(o.descriptionContainer);
                desc.children('div').eq(index).hide();
            }
        };
        
        var showDesc = function(index){
            var o = settings ;
            if (o.description == true){
                var desc = $(o.descriptionContainer);
                desc.children('div').eq(index).show();
            } 
        };
        
        /* ___________________________________ */
        
        /* VIDEO */
        /* ___________________________________ */
        
        var initSpinner = function(){
            var sz = setImageSize(0);
            $('<div class="spinner"></div>')
                .hide()
                .css(setSlidePosition(0))
                .css({'width':sz.width+'px', 'height':sz.height+'px', 'z-index':numberSlides+3, 'position':'absolute', 'cursor':'pointer', 
                    'overflow':'hidden', 'padding':'0', 'margin':'0', 'border':'none'})            
                .appendTo(carousel);
        };
        
        var initVideo = function(){
            initSpinner();
            var sz = setImageSize(0);
            
            $('<div class="videoOverlay"></div>')
                .hide()
                .css(setSlidePosition(0))
                .css({'width':sz.width+'px', 'height':sz.height+'px', 'z-index':numberSlides+2, 'position':'absolute', 
                    'cursor':'pointer', 'overflow':'hidden', 'padding':'0', 'margin':'0', 'border':'none'})            
                .bind('click', videoOverlayClick)
                .appendTo(carousel);
                
            showVideoOverlay(currentSlide); 
        };
              
        var showVideoOverlay = function(index){
            if (slideItems.eq(index).children('a').hasClass('video')){
                carousel.children('.videoOverlay').show();
            } 
        };
    
        var hideVideoOverlay = function(){
            var car = carousel;
            car.children('.videoOverlay')
                .hide()
                .children().remove();
            car.children('.spinner').hide();
        };
    
        var getVideo = function(url){
            var types = videos,
                src;
 
            $.each(types, function(i, e){
                if (url.match(e.reg)){
                    var id = url.split(e.split)[e.index].split('?')[0].split('&')[0];
                    src = e.url.replace("%id%", id);
                }
            });
            return src ;
        };
    
        var addVideoContent = function(){
            var vo = carousel.children('.videoOverlay'),
                url = slideItems.eq(currentSlide).children('a').attr('href'),
                src = getVideo(url);
            
            $('<iframe></iframe>')
                .attr({'width':vo.width()+'px', 'height':vo.height()+'px', 'src':src, 'frameborder':'0'})
                .bind('load', videoLoad)
                .appendTo(vo);
        };
        
        var videoOverlayClick = function(event){
            addVideoContent();
            carousel.children('.spinner').show();
            $(this).hide();
            if (settings.autoplay == true){ 
                stopAutoplay();
                pause = false ;
            }
        };
        
        var videoLoad = function(event){
            var car = carousel;
            car.children('.videoOverlay').show();
            car.children('.spinner').hide();
        };        
                
        /* ________________________________ */
     
        /* AUTOPLAY */
        /* ________________________________ */
        
        var runAutoplay = function(){
            intervalProcess = setInterval(function(){
                goTo(currentSlide+1, false, true);
            }, settings.autoplayInterval);        
            
        };       
    
        var stopAutoplay = function(){
            if (settings.autoplay == true){
                clearInterval(intervalProcess);
                return ;
            }
        };                
        
        
        

        this.prev = function(){
            goTo(currentSlide-1, true, false);
        };
        
        this.next = function(){
            goTo(currentSlide+1, true, false);
        };
        
        this.goTo = function(index){
            goTo(index, true, false);
        };
        
        this.pause = function(){
            stopAutoplay();
            pause = false ;
        };       
        
        this.resume = function(){
            if (settings.autoplay == true){
                runAutoplay();
            }
        };        
                   
    };

 
    $.fn.carousel = function(options){
    
        var returnArr = [];
        for(var i=0; i < this.length; i++){
            if(!this[i].carousel){
                this[i].carousel = new CarouselEvo(this[i], options);
                this[i].carousel.init();
            }
            returnArr.push(this[i].carousel);
        }
        return returnArr.length > 1 ? returnArr : returnArr[0];   

    };

    
    $.fn.carousel.defaults = {
        hAlign:'center', 
        vAlign:'center', 
        hMargin:0.4, 
        vMargin:0.2, 
        frontWidth:202, 
        frontHeight:300, 
        carouselWidth:512, 
        carouselHeight:300, 
        left:0, 
        right:0, 
        top:0, 
        bottom:0, 
        backZoom:0.8, 
        slidesPerScroll:3, 
        speed:500, 
        buttonNav:'none', 
        directionNav:false,
        autoplay:true, 
        autoplayInterval:5000, 
        pauseOnHover:true, 
        mouse:true, 
        shadow:false, 
        reflection:false, 
        reflectionHeight:0.2, 
        reflectionOpacity:0.5, 
        reflectionColor:'255,255,255',
        description:false, descriptionContainer:'.description',
        backOpacity:1,
        before: function(carousel){}, 
        after: function(carousel){}
    };

})(jQuery);